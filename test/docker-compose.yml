services:
  elasticsearch:
    environment:
      ES_JAVA_OPTS: -Xms512m -Xmx512m
      bootstrap.memory_lock: "true"
      discovery.type: single-node
      http.host: 0.0.0.0
      xpack.security.enabled: "false"
    image: docker.elastic.co/elasticsearch/elasticsearch:5.6.12
    mem_limit: 1g
    ulimits:
      memlock:
        hard: -1
        soft: -1
  graylog:
    build:
      args:
        GRAYLOG_VERSION: 3.0.0
        VCS_REF: c7cc30c
      context: /app/src/prv/graylog-docker
      dockerfile: Dockerfile
    environment:
      GRAYLOG_HTTP_EXTERNAL_URI: http://127.0.0.1:9000/
      GRAYLOG_MESSAGE_JOURNAL_ENABLED: "false"
      GRAYLOG_PASSWORD_SECRET: somepasswordpepper
      GRAYLOG_ROOT_PASSWORD_SHA2: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918
      GRAYLOG_SERVER_JAVA_OPTS: -Xmx4G
    links:
    - mongo
    - elasticsearch
    mem_limit: 1g
    ports:
    - 9000:9000/tcp
    - 514:514/tcp
    - 5555:5555/tcp
  mongo:
    image: mongo:3
    mem_limit: 128m
version: '2.0'

